<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Volcano Carousel & Classification</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

<style>
    body {
        background: #f4f4f4;
        padding: 20px;
        font-family: Arial, sans-serif;
        color: #222;
    }
    .container {
        background: #ffffff;
        padding: 20px;
        border-radius: 15px;
        max-width: 600px;
    }

    .carousel-wrapper {
        height: 320px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .volcano-card {
        width: 260px;
        padding: 20px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        text-align: center;
        position: relative;
        transition: box-shadow 0.3s ease;
    }

    .volcano-card img {
        width: 100%;
        height: 180px;
        object-fit: contain;
        user-select: none;
        pointer-events: none;
    }

    .volcano-glow {
        box-shadow: 0 0 20px 5px #ffb400 !important;
    }

    .drag-btn {
        padding: 10px 25px;
        border-radius: 50px;
        margin: 10px;
        font-size: 1rem;
        cursor: grab;
        border: none;
        color: white;
        font-weight: bold;
        position: relative;
        touch-action: none;
    }

    .btn-active { background:#ff4444; }
    .btn-inactive { background:#4066ff; }

    #statusHint {
        margin-top: 10px;
        font-weight: bold;
        font-size: 1.1rem;
        display: none;
    }

    .shake { animation: shake 0.4s; }
    @keyframes shake {
        0% { transform: translateX(0); }
        25% { transform: translateX(-5px); }
        50% { transform: translateX(5px); }
        75% { transform: translateX(-5px); }
        100% { transform: translateX(0); }
    }
</style>
</head>
<body>

<div class="container py-4">

<h2 class="text-center mb-4 fw-bold">Volcano Classification</h2>

<div class="carousel-wrapper">
    <div id="volcanoCard" class="volcano-card">
        <img id="volcanoImage" src="">
        <h4 class="mt-3" id="volcanoName"></h4>
        <div id="statusHint"></div>
    </div>
</div>

<h4 class="text-center fw-bold">Drag classification label</h4>

<div class="text-center">
    <button class="drag-btn btn-active" data-type="active">ACTIVE</button>
    <button class="drag-btn btn-inactive" data-type="inactive">INACTIVE</button>
</div>

<div class="text-center my-3">
    <button class="btn btn-outline-dark px-4" id="prevBtn">Prev</button>
    <button class="btn btn-outline-dark px-4" id="nextBtn">Next</button>
</div>

<hr>

</div>

<script>
/* VOLCANO DATA */
const volcanoes = [
    { name:"Mayon Volcano", status:"active", png:"https://rjhae05.github.io/perciaolivaemodule/assets/Volcano_Mayon.png", gif:"https://rjhae05.github.io/perciaolivaemodule/assets/Volcano_Mayon.gif" },
    { name:"Taal Volcano", status:"active", png:"https://rjhae05.github.io/perciaolivaemodule/assets/Volcano_Taal.png", gif:"https://rjhae05.github.io/perciaolivaemodule/assets/Volcano_Taal.gif" },
    { name:"Mount Apo", status:"inactive", png:"https://rjhae05.github.io/perciaolivaemodule/assets/Mount_Apo.png" },
    { name:"Mount Pinatubo", status:"active", png:"https://rjhae05.github.io/perciaolivaemodule/assets/Mount_Pinatubo.png", gif:"https://rjhae05.github.io/perciaolivaemodule/assets/Mount_Pinatubo.gif" },
    { name:"Mount Isarog", status:"active", png:"https://rjhae05.github.io/perciaolivaemodule/assets/Mount_Isarog.png", gif:"https://rjhae05.github.io/perciaolivaemodule/assets/Mount_Isarog.gif" }
];

let index = 0;

const card = document.getElementById("volcanoCard");
const img = document.getElementById("volcanoImage");
const nameBox = document.getElementById("volcanoName");
const statusHint = document.getElementById("statusHint");

function loadVolcano(i) {
    const v = volcanoes[i];

    card.dataset.status = v.status;
    card.dataset.png = v.png;
    card.dataset.gif = v.gif ?? "";

    img.src = v.png;
    nameBox.textContent = v.name;

    statusHint.style.display = "none";
    card.classList.remove("volcano-glow");
}

loadVolcano(0);

document.getElementById("nextBtn").onclick = () => {
    index = (index + 1) % volcanoes.length;
    loadVolcano(index);
};

document.getElementById("prevBtn").onclick = () => {
    index = (index - 1 + volcanoes.length) % volcanoes.length;
    loadVolcano(index);
};

/* -------------------------------
      DRAG & DROP (TOUCH + PC)
--------------------------------*/
let draggedType = "";
let activeDrag = null;

document.querySelectorAll(".drag-btn").forEach(btn => {

    // PC DRAG
    btn.draggable = true;
    btn.addEventListener("dragstart", () => {
        draggedType = btn.dataset.type;
        statusHint.style.display = "block";
        statusHint.textContent = "Drop here to classify!";
    });
    btn.addEventListener("dragend", () => statusHint.style.display = "none");

    // MOBILE TOUCH DRAG
    btn.addEventListener("touchstart", e => {
        activeDrag = btn;
        draggedType = btn.dataset.type;

        btn.style.position = "absolute";
        btn.style.zIndex = 1000;
        statusHint.style.display = "block";
        statusHint.textContent = "Drop here to classify!";

        moveAt(e.touches[0].clientX, e.touches[0].clientY);
        e.preventDefault();
    });

    btn.addEventListener("touchmove", e => {
        if (!activeDrag) return;
        moveAt(e.touches[0].clientX, e.touches[0].clientY);
        e.preventDefault();
    });

    btn.addEventListener("touchend", e => {
        if (!activeDrag) return;

        checkDrop(e.changedTouches[0].clientX, e.changedTouches[0].clientY);

        activeDrag.style.position = "relative";
        activeDrag.style.left = "0px";
        activeDrag.style.top = "0px";
        activeDrag.style.zIndex = "auto";

        activeDrag = null;
        statusHint.style.display = "none";
    });
});

// MOVE BUTTON FOLLOWING FINGER
function moveAt(x, y) {
    activeDrag.style.left = x - activeDrag.offsetWidth / 2 + "px";
    activeDrag.style.top = y - activeDrag.offsetHeight / 2 + "px";
}

// MOBILE DROP CHECK
function checkDrop(x, y) {
    const rect = card.getBoundingClientRect();
    if (x > rect.left && x < rect.right && y > rect.top && y < rect.bottom) {
        processDrop();
    }
}

// PC DROP
card.addEventListener("dragover", e => e.preventDefault());
card.addEventListener("drop", processDrop);

function processDrop() {
    const correctStatus = card.dataset.status;

    if (draggedType !== correctStatus) {
        card.classList.add("shake");
        setTimeout(() => card.classList.remove("shake"), 400);
        return;
    }

    if (!card.dataset.gif) {
        card.classList.add("volcano-glow");
        setTimeout(() => card.classList.remove("volcano-glow"), 2000);
    } else {
        img.src = card.dataset.gif;
        setTimeout(() => img.src = card.dataset.png, 2500);
    }
}
</script>

</body>
</html>
